# language setting
language: ruby

# build and process only release branches
branches:
  only:
    - master
    
rvm:
  - 2.2.4
  
services:
    - postgres
    
env:
  global:
    - CI_REPORTS=shippable/testresults COVERAGE_REPORTS=shippable/codecoverage
    - USER=postgres
    
build:
  pre_ci_boot:
    image_name: drydock/u14rubpls
    image_tag: prod
    pull: true
    options: --privileged=true
  ci:    
    - mkdir -p $CI_REPORTS
    - mkdir -p $COVERAGE_REPORTS
    - mkdir -p ~/.aws   
    - psql -c 'create database myapp_test;' -U $USER
    - bundle install
